<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    .sprite {
        width: 60px;
        height: 50px;
        display: block;
        border-radius: 3px;
    }

    .f_row {
        display: flex;
    }

    .f_cell {
        margin: 1px;
    }

</style>
<body>
    <div id="field_place">

    </div>
</body>
<script>
    var N = 12
    var M = 20
    // var grass_img_src = 'https://images.freeimages.com/images/large-previews/7ef/grass-texture-1166117.jpg'
    var grass_img_src = 'https://thumbs.dreamstime.com/b/%D0%BA%D1%83%D0%BB%D1%8C%D1%82%D0%B8%D0%B2%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%88%D0%B5%D0%BD%D0%B8%D1%86%D0%B0-616754.jpg'

    function create_matrix(){
        var matrix = []
        for (i=0; i<N; i+=1){
            var row = []
            for (j=0; j<M; j+=1){
                row.push(grass_img_src)
            }
            matrix.push(row)
        }
        return matrix
    }


    function draw_matrix2(matrix){
        var field = document.getElementById('field_place')

        var field_html = '<table>'
        for (row of matrix){
            field_html += '<tr>'
            for (img_src of row){
                field_html += `<td><img class='sprite' src='${img_src}'></td>`
            }
            field_html += '</tr>'
        }
        field_html += '</table>'

        field.innerHTML = field_html
    }

    function draw_matrix(matrix){
        var field = document.getElementById('field_place')

        var field_html = '<div id="field">'
        for (row of matrix){
            field_html += '<div class="f_row">'
            for (img_src of row){
                field_html += `<div class="f_cell"><img class='sprite' src='${img_src}'></div>`
            }
            field_html += '</div>'
        }
        field_html += '</div>'

        field.innerHTML = field_html
    }

    class GameObject{
        constructor(coords, sprite_src){
            this.coords = coords
            this.sprite_src = sprite_src
        }

        draw (matrix){
            matrix[this.coords[0]][this.coords[1]] = this.sprite_src
        }

        move (direction){
            if (direction == 'w'){
                this.coords[0] -= 1
            }
            else if (direction == 'a'){
                this.coords[1] -= 1
            }
            else if (direction == 's'){
                this.coords[0] += 1
            }
            else if (direction == 'd') {
                this.coords[1] += 1
            }
        }
    } 

    class Player extends GameObject {
        constructor(name, coords, hp, sprite_src){
            super(coords, sprite_src)
            this.name = name
            this.hp = hp
        }
    }


    function on_key_down(event){
        document.removeEventListener('keydown', on_key_down)
        if (['w', 'a', 's', 'd'].includes(event.key)){
            player.move(event.key)
        }
        one_round(player)
    }
    
    function one_round(player){
        var matrix = create_matrix()
        player.draw(matrix)
        draw_matrix(matrix)
        document.addEventListener('keydown', on_key_down)
    }

    var player = new Player('Bob', [1, 5], 10, 'https://graphicriver.img.customer.envatousercontent.com/files/253361666/Envato_590x700.jpg?auto=compress%2Cformat&q=80&fit=crop&crop=top&max-h=8000&max-w=590&s=e760737bff08c6cf5a95c30bcffe87c1')
    one_round(player)

</script>
</html>